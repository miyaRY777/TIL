画像の手書きメモを読み取り、FactoryBot（fixture/sequence/create/build）まわりの要点をTIL形式で短く整理してまとめます。


## TIL: Fixture / FactoryBot（factory・sequence・create・build）

### 学んだこと（要点）

* **fixture**

  * テスト用データを **YAMLで固定** して用意する仕組み。
  * 便利だけど「データが固定で増える・依存が増えやすい」ので、最近は **FactoryBotを使う現場も多い**。

* **FactoryBot の `factory` は「設計図」**

  * `factory :hobby` は **Hobbyモデルのテストデータ生成ルール（設計図）** を定義しているイメージ。
  * 以降は `create(:hobby)` / `build(:hobby)` みたいに **簡単に呼び出して使える**。

* **`sequence` は「連番でユニーク値を作る」**

  * `sequence(:email)` / `sequence(:name)` は、呼ぶたびに `n` が増えて **重複しない値を自動生成** する。
  * **なぜ必要？**

    * `email` や `name` に **uniqueness制約** があると、同じ値だとバリデーションで落ちる → テストが安定しない
    * だから `sequence` で **毎回ユニークにする**

* **`create` と `build` の違い**

  * `create(:hobby)`：**DBに保存される**（`INSERT`される）
  * `build(:hobby)`：**DBに保存されない**（メモリ上のインスタンスだけ）

---

### 具体例（コピペ用）

```rb
FactoryBot.define do
  factory :hobby do
    sequence(:name) { |n| "hobby#{n}" } # hobby0, hobby1, ...
  end
end
```

```rb
create(:hobby) # => DB保存される
build(:hobby)  # => DB保存されない（valid? など確認用に便利）
```

```rb
FactoryBot.define do
  factory :user do
    sequence(:email) { |n| "user#{n}@example.com" } # 重複回避
    password { "password123" }
  end
end
```

---

### ちょいメモ（作業効率）

* **Shift + Tab**：インデントを戻す（コードの字下げを左に戻す）

---

### 次に意識すること

* **「DB保存が必要か？」で `build` / `create` を使い分ける**
* **ユニーク制約がある属性（email/nameなど）は `sequence` を基本で付ける**
