ActiveStorage ã® main_images ã‚’ Railsã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§ç¢ºèªã™ã‚‹æ‰‹é †

#Swiper

---
# å‰æçŸ¥è­˜

**`main_images` ã¨ã¯ã€ŒSiteï¼ˆãƒ–ãƒ­ã‚°ï¼‰ã«ç´ã¥ãâ€œãƒˆãƒƒãƒ—ç”¨ã®è¤‡æ•°ç”»åƒâ€ã‚’è¡¨ã™ ActiveStorage ã®æ·»ä»˜åã€**ã§ã™ã€‚


---

## æ­£ã—ã„ç¢ºèªæ–¹æ³•ï¼ˆé †ç•ªã«ï¼‰

### â‘  Rails ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’èµ·å‹•ã™ã‚‹

Dockerç’°å¢ƒãªã®ã§ã€ã“ã‚Œã§ã™ğŸ‘‡

```bash
docker compose exec web bin/rails c
```

æˆåŠŸã™ã‚‹ã¨ï¼š

```text
Loading development environment (Rails 5.x.x)
irb(main):001>
```

ã«ãªã‚Šã¾ã™ã€‚

---

### â‘¡ `current_site` ã®ä»£ã‚ã‚Šã‚’ç”¨æ„ã™ã‚‹

å¤šãã®RUNTEQèª²é¡Œã§ã¯ï¼š

```ruby
Site.first
```

ã‚„

```ruby
Site.find(1)
```

ãŒ `current_site` ã«ç›¸å½“ã—ã¾ã™ã€‚

```ruby
site = Site.first
```

---

### â‘¢ main_images ã‚’ç¢ºèªã™ã‚‹

```ruby
site.main_images
```

ğŸ‘‰ ã“ã‚Œã¯ **é–¢é€£ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®ä¸€è¦§**

---

### â‘£ ç”»åƒãŒã‚ã‚‹ã‹ç¢ºèªï¼ˆé‡è¦ï¼‰

```ruby
site.main_images.attached?
# => true / false
```

```ruby
site.main_images.count
# => 0, 1, 2...
```

---

## ã“ã“ã§ã®çµæœã®æ„å‘³

### ã‚±ãƒ¼ã‚¹â‘ 

```ruby
site.main_images.attached?
# => false
```

ğŸ‘‰ **ç®¡ç†ç”»é¢ã§ã¾ã ç”»åƒã‚’ç™»éŒ²ã—ã¦ã„ãªã„**

---

### ã‚±ãƒ¼ã‚¹â‘¡

```ruby
site.main_images.count
# => 1
```

ğŸ‘‰ ç”»åƒã¯ã‚ã‚‹  
ğŸ‘‰ loop warning ãŒå‡ºã‚‹ã®ã¯æ­£å¸¸

---

### ã‚±ãƒ¼ã‚¹â‘¢

```ruby
site.main_images.count
# => 2ä»¥ä¸Š
```

ğŸ‘‰ Swiper loop ãŒå®Œå…¨ã«æ©Ÿèƒ½ã™ã‚‹çŠ¶æ…‹

---

## ç”»åƒã®ä¸­èº«ã‚’1æšãšã¤è¦‹ã‚‹

```ruby
site.main_images.each do |img|
  puts img.filename
end
```

ä¾‹ï¼š

```text
header1.jpg
header2.png
```

---

## ã•ã‚‰ã«æ·±ãç¢ºèªã—ãŸã„å ´åˆï¼ˆå®‰å¿ƒç”¨ï¼‰

```ruby
site.main_images.first.blob
```

```ruby
site.main_images.first.blob.filename.to_s
```

---

## ã‚ˆãã‚ã‚‹å‹˜é•ã„ã¾ã¨ã‚

|ã‚„ã‚ŠãŒã¡|æ­£è§£|
|---|---|
|ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã«ç›´æ¥æ‰“ã¤|âŒ|
|rails c ã‚’ä½¿ã†|âœ…|
|current_site ã‚’ä½¿ã†|âŒ|
|Site.first ã‚’ä½¿ã†|âœ…|

---

## ä»Šã®ã‚ãªãŸã®é€²æ—çš„ã«

- Railsã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ä½¿ãˆã‚‹ç†è§£ âœ…
    
- ActiveStorage ã®ç¢ºèªæ–¹æ³•ç†è§£ âœ…
    
- Swiper warning ã®ç†ç”±ç†è§£ âœ…
    

ğŸ‘‰ **ã‹ãªã‚Šè‰¯ã„ä½ç½®**ã§ã™ã€‚

---

æ¬¡ã«ã‚„ã‚‹ã¨ã—ãŸã‚‰ãŠã™ã™ã‚ã¯ğŸ‘‡

- ğŸ‘‰ `main_images` ãŒ 0 / 1 / è¤‡æ•° ã®ã¨ãã® View åˆ†å²
    
- ğŸ‘‰ console ã§ç”»åƒå‰Šé™¤ã‚’è©¦ã™ï¼ˆ`purge`ï¼‰
    
- ğŸ‘‰ ç®¡ç†ç”»é¢æ“ä½œ â†’ console ã§è¿½è·¡
    

ã©ã‚Œã‚’ä¸€ç·’ã«ç¢ºèªã—ã¾ã™ã‹ï¼Ÿ