#daily

## 今日取り組んだタスク

- [ ] Rails応用６、７
- [ ] スッキリわかるSQL入門

---
## 一言

7月からスッキリわかるSQL入門を少しずつ学習してきましたが
この問題集についているドリル、、、1問も解いていませんでした🤣
２周目確定っすねw

---
## 学習内容

### SQL

##### トランザクションの分離

説明：
分離性とは、複数が同時に実行しても
お互いに邪魔しない状態を保つための仕組みのことを指します！

この分離性が弱いと、、、以下の副作用が発生しています、、、
- ダーティーリード
- 反復不能読み取り
- ファントムリード

###### 分離性を実現するためには？

説明：
DBMSによって、行やテーブルにないブロックをかけることで
同時更新の競合を防ぎます！！！

これは
1. あるトランザクションAが現在読み書きしている行に鍵をかけ、他の人からは読み書きでないようにし
2. トランザクションAがコミット or ロールバックすると、かけた鍵は解除され
3. 他の人のトランザックションBがその行を読み書きできるようにしています！

しかし、デメリットとして
トランザクションBは、トランザクションAが完了するまで待たされます、、、
このロック自体は、通常はかなり短いものですが
ロックがたくさん発生すると、データベースのの動作は非常に遅くなってしまいます、、、

##### 分離レベル

説明：
ロックの仕組みを利用すれば、副作用が発生しないようになりますが、
一方、DBMSのパフォーマンスが低下してしまいます、、、
それゆえ
このような正確なデータ操作とパフォーマンスは二律背反の関係にあるように思えますが
どちらか片方しか選べないわけではありません！

多くのDBMSには、どの程度厳密にトランザクションを分離するかを
トランザクション分離レベルとして指定することができます！

| 分離レベル                         | ダーティーリード | 反復不能読み取り | ファントムリード        |
| ----------------------------- | -------- | -------- | --------------- |
| **READ UNCOMMITTED**          | 起こる      | 起こる      | 起こる             |
| **READ COMMITTED**（多くのDBの初期値） | 起きない     | 起こる      | 起こる             |
| **REPEATABLE READ**           | 起きない     | 起きない     | 起こる（DBにより挙動差あり） |
| **SERIALIZABLE**              | 起きない     | 起きない     | 起きない            |

上に行けば行くほど、高速だが危険 / 下に行けば行くほど、安全だが低速

トランザクション分離レベルの指定
```sql
/*どっちを使うかは、DBMSによって異なる*/
SET TRANSACTION ISOLATION LEVEL 分離レベル名
SET CURRENT ISOLATION 分離レベル名
```

どの分離レベルを選べばいいか迷いますが
大抵の場合は、**READ COMMITTED**を選べばいいらしいです！
あとは必要に応じて、適切な分離レベルを選びます！


---
## 学んだこと

- トランザクションの分離性について

---
## 教材

- スッキリわかるSQL入門

---
##### ⏳ 学習時間: 6時間  
##### 🌱 コミット数: １コミット