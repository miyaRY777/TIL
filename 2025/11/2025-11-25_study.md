#daily

## 今日取り組んだタスク

- [ ] 応用４
- [ ] 応用５
- [ ] スッキリわかるSQL入門8章

---
## 一言

ようやく応用４が終わりました、、、
警告であなたのメソッド複雑すぎ！っと言われ、2日ぐらい試行錯誤しながら記述してました💦
やはりifの多用はよろしくないですねw

---
## 学習内容
### Ruby / Rails
```ruby
# 書いたコード
```

### SQL

##### テーブル名の指定
説明：
2つのテーブルを結合するとき
同じ名称の列が複数登場する場合があります、、、
DBMSは、どちらのテーブルの列を取り出せば良いのかわかりません💦
このような時、どのテーブルに属する列であるのか `テーブル名+.(ドット)` で明示的に指定します！

具体例：２種類のメモを取得したい
```sql
/*家計簿*/
|日付|費目ID|メモ|入金額|出金額|
|2024-02-03|2|カフェラテを購入|0|380|
|2024-02-05|2|昼食（日の出食堂）|0|750|
|2024-02-10|1|1月の給料|280000|0|

/*費目*/
|ID|名前|メモ|
|1|給料|給与や賞与|
|2|食費|食事代（ただし飲み会などの外食を除く）|
|3|水道光熱費|水道代・電気代・ガス代|
```

SQL：
```sql

SELECT 日付, 家計簿.メモ, 費目.メモ
FROM 家計簿
JOIN 費目
ON 家計簿.ID = 費目.ID

/*別名を利用したver*/
SELECT 日付, K.メモ, H.メモ
FROM 家計簿 AS K
JOIN 費目AS H
ON K.ID = H.ID

```

出力：
```sql
|日付|メモ|メモ|

|2024-02-03|カフェラテを購入|食事代（ただし飲み会などの外食を除く）|
|2024-02-05|昼食（日の出食堂）|食事代（ただし飲み会などの外食を除く）|
|2024-02-10|1月の給料|給与や賞与|
```

##### 3つテーブル以上の結合
```sql
/*家計簿*/
|家計簿|費目|経費区分|
|2024-02-03|2|カフェラテを購入|0|380|
|2024-02-05|2|昼食（日の出食堂）|0|750|
|2024-02-10|1|1月の給料|280000|0|

/*費目*/
|ID|名前|経費区分ID|メモ|
|1|給料|2|給与や賞与|
|2|食費|1|食事代（ただし飲み会などの外食を除く）|
|3|水道光熱費|1|水道代・電気代・ガス代|

/*経費区分*/
|ID|名称|
|1|支出|
|2|収入|
```

SQL：
```sql
SELECT 日付, 費目.名前, 経費区分.名称
  FROM 家計簿
  JOIN 費目
    ON 家計簿.費目ID = 費目.ID
  JOIN 経費区分
    ON 費目.経費区分ID = 経費区分.ID
```

家計簿テーブルに対して、まずは費目テーブルを結合させる
その次に、その結果と経費区分テーブルを結合させる
つまり
前から順に１ずつ結合処理が行われていきます！

出力：
```sql
|日付|名前|名称|
|2024-02-05|食費|支出|
|2024-02-03|食費|支出|
|2024-02-10|給料|収入|
```


##### 副問い合わせの結果との結合

説明：
JOIN句のすぐ後ろに記述できるのは、実はテーブルだけはなく、表形式に化ける副問い合わせも記述することが可能です！

具体例：
```sql
/*家計簿*/
|家計簿|費目|経費区分|
|2024-02-03|2|カフェラテを購入|0|380|
|2024-02-05|2|昼食（日の出食堂）|0|750|
|2024-02-10|1|1月の給料|280000|0|

/*費目*/
|ID|名前|経費区分ID|メモ|
|1|給料|2|給与や賞与|
|2|食費|1|食事代（ただし飲み会などの外食を除く）|
|3|水道光熱費|1|水道代・電気代・ガス代|

/*経費区分*/
|ID|名称|
|1|支出|
|2|収入|
```

SQL：
```sql
SELECT 日付, 費目.名前, 費目.経費区分ID
  FROM 家計簿
  JOIN ( SELECT * FROM 費目 WHERE 経費区分ID = 1) AS 費目
    ON 家計簿.費目ID = 費目.ID

```

出力：
```sql
|日付|名前|経費区分ID|
|2024-02-03|食費|1|
|2024-02-05|食費|1|
```

---
## 学んだこと

SQL
- テーブル名を指定することで、別々のテーブルから同じカラムを取り出す方法
- 3つ以上のテーブルの結合の仕方
- 副問い合わせの結果との結合の仕方



---
## 教材

- スッキリわかるSQL入門

---
##### ⏳ 学習時間: 7.6時間  
##### 🌱 コミット数: １コミット